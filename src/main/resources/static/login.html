<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>EventBooking — Login</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r121/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>

    <style>
        body {
          font-family: 'Inter', sans-serif;
          background: linear-gradient(135deg,#0f172a 0%,#1e293b 100%);
          color: #f8fafc;
          min-height: 100vh;
          display: flex;
          justify-content: center;
          align-items: center;
          margin: 0;
          overflow: hidden;
        }

        #vanta-bg {
          position: fixed !important;
          top: 0; left: 0;
          width: 100vw !important;
          height: 100vh !important;
          z-index: -10;
        }

        .login-container {
          background: rgba(255,255,255,0.07);
          border: 1px solid rgba(255,255,255,0.2);
          backdrop-filter: blur(35px);
          border-radius: 32px;
          padding: 3rem 3rem;
          max-width: 420px;
          width: 100%;
          text-align: center;
          box-shadow: 0 25px 80px rgba(0,0,0,0.7);
          transition: all 0.4s ease;
        }

        .login-container:hover {
          transform: translateY(-6px) scale(1.03);
          box-shadow: 0 35px 100px rgba(0,0,0,0.85);
        }

        h1 {
          font-size: 3rem;
          font-weight: 900;
          margin-bottom: 2.5rem;
          background: linear-gradient(90deg,#6366f1,#8b5cf6,#ec4899);
          -webkit-background-clip: text;
          color: transparent;
          letter-spacing: 1px;
        }

        label {
          display: block;
          text-align: left;
          margin-bottom: 0.5rem;
          font-weight: 600;
          color: #cbd5e1;
          font-size: 0.9rem;
          text-transform: uppercase;
          letter-spacing: 1px;
        }

        input[type="email"],
        input[type="password"] {
          width: 100%;
          padding: 1.4rem 1.5rem;
          border-radius: 18px;
          border: 1px solid rgba(255,255,255,0.25);
          background: rgba(255,255,255,0.12);
          color: #f8fafc;
          font-size: 1.05rem;
          margin-bottom: 1.8rem;
          transition: all 0.4s ease;
        }

        input[type="email"]::placeholder,
        input[type="password"]::placeholder {
          color: #cbd5e1;
        }

        input[type="email"]:focus,
        input[type="password"]:focus {
          outline: none;
          border-color: #8b5cf6;
          background: rgba(255,255,255,0.2);
          box-shadow: 0 0 20px rgba(139,92,246,0.35);
        }

        button {
          width: 100%;
          padding: 1.5rem;
          border-radius: 28px;
          font-weight: 800;
          font-size: 1.25rem;
          text-transform: uppercase;
          letter-spacing: 1px;
          cursor: pointer;
          border: none;
          background: linear-gradient(135deg,#6366f1,#8b5cf6,#ec4899);
          color: #fff;
          box-shadow: 0 12px 50px rgba(99,102,241,0.45);
          transition: all 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
          position: relative;
          overflow: hidden;
        }

        button::before {
          content: '';
          position: absolute;
          top: -50%;
          left: -50%;
          width: 200%;
          height: 200%;
          background: rgba(255,255,255,0.15);
          transform: rotate(45deg) scale(0);
          transition: transform 0.5s ease;
          border-radius: 50%;
          pointer-events: none;
        }

        button:hover::before {
          transform: rotate(45deg) scale(1);
        }

        button:hover {
          transform: scale(1.06) translateY(-2px);
          box-shadow: 0 18px 60px rgba(139,92,246,0.6);
        }

        button:active {
          transform: scale(0.98) translateY(1px);
          box-shadow: 0 10px 30px rgba(139,92,246,0.5);
        }

        .message {
          text-align: center;
          font-weight: 600;
          padding: 0.9rem 1rem;
          border-radius: 14px;
          margin-bottom: 1.8rem;
          font-size: 1rem;
          display: none;
          transition: all 0.3s ease;
        }

        .message.success {
          background: rgba(16,185,129,0.15);
          color: #10b981;
        }

        .message.error {
          background: rgba(239,68,68,0.15);
          color: #ef4444;
        }

        .signup-link {
          display: block;
          margin-top: 1.8rem;
          font-weight: 600;
          color: #8b5cf6;
          text-decoration: underline;
          cursor: pointer;
          transition: color 0.3s ease;
        }

        .signup-link:hover {
          color: #ec4899;
        }

        @media(max-width:450px){
          .login-container {
            padding: 2.5rem 2rem;
          }
          h1 {
            font-size: 2.4rem;
          }
          input[type="email"], input[type="password"] {
            padding: 1.2rem 1rem;
          }
          button {
            padding: 1.3rem;
            font-size: 1.15rem;
          }
        }
    </style>
</head>
<body>

<div id="vanta-bg"></div>

<div class="login-container" data-aos="fade-up">
    <h1>EventBooking</h1>
    <div id="message" class="message"></div>
    <form id="loginForm" autocomplete="off">
        <label for="email">Email Address</label>
        <input type="email" id="email" name="email" placeholder="you@example.com" required>

        <label for="password">Password</label>
        <input type="password" id="password" name="password" placeholder="••••••••" required>

        <button type="submit">Log In</button>
    </form>
    <a href="signup.html" class="signup-link">Don't have an account? Sign Up</a>
</div>

<script>
    VANTA.NET({
      el: "#vanta-bg",
      color: 0x6366f1,
      backgroundColor: 0x0f172a,
      points: 15,
      maxDistance: 30,
      spacing: 25
    });

    document.addEventListener('DOMContentLoaded', () => {
      AOS.init({ duration: 800, once: true });
    });

    const messageDiv = document.getElementById('message');

    function showMessage(text, type='success'){
      messageDiv.textContent = text;
      messageDiv.className = 'message ' + type;
      messageDiv.style.display = 'block';
    }

    document.getElementById('loginForm').addEventListener('submit', async function(e){
      e.preventDefault();
      const email = this.email.value.trim();
      const password = this.password.value.trim();

      if(!email || !password){
        showMessage('Please fill in both fields.', 'error');
        return;
      }

      const response = await fetch('/users/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
      });

      const data = await response.json();

      if(!response.ok){
        showMessage(data.message || 'Invalid credentials', 'error');
        return;
      }

      sessionStorage.setItem("userEmail", data.email);
      sessionStorage.setItem("userName", data.name);
      sessionStorage.setItem("userId", data.id);

      showMessage('Login successful! Redirecting...', 'success');

      setTimeout(() => {
        window.location.href = 'index.html';
      }, 1500);
    });
</script>
</body>
</html>
